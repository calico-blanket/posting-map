# Project Progress: Posting Map Application

## Project Overview
Development of a PWA-compatible mapping application for managing posting/distribution activities ("Team Mirai").
**Tech Stack:** Next.js 16 (App Router), Firebase (Auth, Firestore), Leaflet (React-Leaflet), Tailwind CSS, Vercel.

## Development Roadmap & Milestones

### 1. Initial Setup & Core Features
- Established Next.js project structure with TypeScript.
- Integrated **Firebase Authentication** (Google Login).
- Implemented **Leaflet Map** with drawing capabilities (`leaflet-draw`).
- **Challenge:** Firestore does not support nested arrays directly (GeoJSON `coordinates`).
- **Solution:** Created a custom data converter to serialize Geometry data before saving.

### 2. Map & UI Functionality
- Added "User Location" tracking.
- Implemented "Auto-Center" on startup for better UX.
- Created `AreaEditForm` inside popups for managing area status (Planned/Completed/Cancelled) and memos.
- **Challenge:** Click propagation issues where clicking a form button would also click the map.
- **Solution:** Applied `e.stopPropagation()` to form events.

### 3. PWA Implementation
- Configured `next-pwa` to enable installation on mobile devices.
- Created `manifest.json` and added mobile-specific metadata to `layout.tsx`.
- **Challenge:** Next.js 16 defaults to Turbopack, which conflicted with `next-pwa` (Webpack plugin).
- **Solution:** Forced Webpack build using `next build --webpack` in `package.json`.

### 4. Deployment & Security
- Deployed to **Vercel**.
- Configured Environment Variables (`.env.local` -> Vercel Project Settings).
- **Challenge:** "Internal Server Error" / "WorkerError" during Vercel build.
- **Solution:** Resolved by fixing the Turbopack/Webpack conflict mentioned above.
- **Challenge:** "Permission Denied" from Firestore in production.
- **Solution:** Updated Firestore Security Rules and added Vercel domain to Firebase Auth Allowlist.

### 5. Design & Branding
- Generated custom App Icons using AI (Mint Green + Yellow Pin theme).
- Updated application theme colors to "Teal/Mint" to match the organization's brand.

### 6. Miscellaneous
- Attempted to create a specialized demo video via automation (skipped to prioritize stability).
- Established a clean Git workflow with a dedicated repository.

## Current Status (2025-12-27)
- **Status:** Fully functional, deployed, and installable on mobile.
- **URL:** [Vercel Deployment URL]
- **Next Potential Steps:**
    - Data export (CSV/Excel).
    - User allowlist implementation for security.
